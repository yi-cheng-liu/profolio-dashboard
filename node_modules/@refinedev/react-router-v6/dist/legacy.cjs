var O=Object.create;var A=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty;var q=(t,o)=>{for(var n in o)A(t,n,{get:o[n],enumerable:!0})},U=(t,o,n,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let p of V(o))!_.call(t,p)&&p!==n&&A(t,p,{get:()=>o[p],enumerable:!(c=z(o,p))||c.enumerable});return t};var B=(t,o,n)=>(n=t!=null?O(K(t)):{},U(o||!t||!t.__esModule?A(n,"default",{value:t,enumerable:!0}):n,t)),G=t=>U(A({},"__esModule",{value:!0}),t);var Z={};q(Z,{BrowserRouterComponent:()=>I,HashRouterComponent:()=>j,MemoryRouterComponent:()=>$,default:()=>Y});module.exports=G(Z);var X=require("@refinedev/core"),h=require("react-router-dom");var R=B(require("react")),b=require("react-router-dom");var e=B(require("react")),u=require("react-router-dom"),r=require("@refinedev/core"),k=({route:t})=>{let{catchAll:o}=(0,r.useRefineContext)(),{useParams:n}=(0,r.useRouterContext)(),{resources:c}=(0,r.useResource)(),{action:p,id:m}=n(),s=c.find(y=>y.route===t);if(s){let{list:y,create:P,edit:f,show:w,name:d,canCreate:g,canEdit:E,canShow:C,canDelete:L,options:i}=s,l=()=>console.error("`string` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),a=()=>console.error("`Object` resource routes are not supported in legacy router. Please switch to the new router or assign Components to the resource routes."),x=(typeof y=="string"?l():typeof y=="object"?a():y)??(()=>null),D=(typeof P=="string"?l():typeof P=="object"?a():P)??(()=>null),F=(typeof f=="string"?l():typeof f=="object"?a():f)??(()=>null),N=(typeof w=="string"?l():typeof w=="object"?a():w)??(()=>null);return(()=>{switch(p){case void 0:return e.default.createElement(r.CanAccess,{resource:d,action:"list",fallback:o??e.default.createElement(r.ErrorComponent,null),params:{resource:s}},y?e.default.createElement(x,{name:d,canCreate:g,canEdit:E,canDelete:L,canShow:C,options:i}):o??e.default.createElement(r.ErrorComponent,null));case"create":case"clone":return e.default.createElement(r.CanAccess,{resource:d,action:"create",fallback:o??e.default.createElement(r.ErrorComponent,null),params:{id:m?decodeURIComponent(m):void 0,resource:s}},P?e.default.createElement(D,{name:d,canCreate:g,canEdit:E,canDelete:L,canShow:C,options:i}):o??e.default.createElement(r.ErrorComponent,null));case"edit":return e.default.createElement(r.CanAccess,{resource:d,action:"edit",params:{id:m?decodeURIComponent(m):void 0,resource:s},fallback:o??e.default.createElement(r.ErrorComponent,null)},f?e.default.createElement(F,{name:d,canCreate:g,canEdit:E,canDelete:L,canShow:C,options:i}):o??e.default.createElement(r.ErrorComponent,null));case"show":return e.default.createElement(r.CanAccess,{resource:d,action:"show",params:{id:m?decodeURIComponent(m):void 0,resource:s},fallback:o??e.default.createElement(r.ErrorComponent,null)},w?e.default.createElement(N,{name:d,canCreate:g,canEdit:E,canDelete:L,canShow:C,options:i}):o??e.default.createElement(r.ErrorComponent,null));default:return e.default.createElement(e.default.Fragment,null,o??e.default.createElement(r.ErrorComponent,null))}})()}return e.default.createElement(e.default.Fragment,null,o??e.default.createElement(r.ErrorComponent,null))},S=({initialRoute:t})=>{let{resources:o}=(0,r.useResource)(),{catchAll:n,DashboardPage:c,LoginPage:p}=(0,r.useRefineContext)(),{routes:m}=(0,r.useRouterContext)(),s=(0,r.useActiveAuthProvider)(),{isFetching:y,isError:P,data:f}=(0,r.useIsAuthenticated)({v3LegacyAuthProviderCompatible:!!(s!=null&&s.isLegacy),params:{type:"routeProvider"}}),w=(0,e.useMemo)(()=>s!=null&&s.isProvided?s!=null&&s.isLegacy?!(P||(f==null?void 0:f.error)):f==null?void 0:f.authenticated:!0,[f,P,s==null?void 0:s.isLegacy]);if(y)return e.default.createElement(u.Routes,null,e.default.createElement(u.Route,{path:"*",element:null}));let d=()=>{let{pathname:i,search:l}=location,a=`${i}${l}`;return e.default.createElement(u.Navigate,{to:`/login?to=${encodeURIComponent(a)}`})},g=[];o.map(i=>{let l=e.default.createElement(u.Route,{key:`${i.route}`,path:`${i.route}`,element:e.default.createElement(k,{route:i.route})},e.default.createElement(u.Route,{path:":action",element:e.default.createElement(k,{route:i.route})},e.default.createElement(u.Route,{path:":id",element:e.default.createElement(k,{route:i.route})})));g.push(l)});let E=()=>{var i,l;return e.default.createElement(u.Routes,null,[...m||[]].filter(a=>!a.layout).map((a,x)=>e.default.createElement(u.Route,{key:`custom-route-${x}`,...a,element:a.element})),e.default.createElement(u.Route,{path:"/",element:e.default.createElement(r.LayoutWrapper,null,e.default.createElement(u.Outlet,null))},[...m||[]].filter(a=>a.layout).map((a,x)=>e.default.createElement(u.Route,{key:`custom-route-${x}`,...a,element:a.element})),c?e.default.createElement(u.Route,{index:!0,element:e.default.createElement(r.CanAccess,{resource:"dashboard",action:"list",fallback:n??e.default.createElement(r.ErrorComponent,null)},e.default.createElement(c,null))}):e.default.createElement(u.Route,{index:!0,element:e.default.createElement(u.Navigate,{to:t??`/${(l=(i=o.find(a=>a.list))==null?void 0:i.route)==null?void 0:l.replace(/^\//,"")}`})}),...[...g||[]],e.default.createElement(u.Route,{path:"*",element:e.default.createElement(k,{route:""})})))},C=()=>p?e.default.createElement(p,null):e.default.createElement(r.LoginPage,null);return w?E():(()=>e.default.createElement(u.Routes,null,[...m||[]].map((i,l)=>e.default.createElement(u.Route,{key:`custom-route-${l}`,...i})),e.default.createElement(u.Route,{path:"/",element:C()}),e.default.createElement(u.Route,{path:"/login",element:C()}),e.default.createElement(u.Route,{path:"*",element:e.default.createElement(d,null)})))()};function I({children:t,...o}){return R.default.createElement(b.BrowserRouter,{...o},R.default.createElement(S,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),t)}function $({children:t,...o}){return R.default.createElement(b.MemoryRouter,{...o},R.default.createElement(S,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),t)}function j({children:t,...o}){return R.default.createElement(b.HashRouter,{...o},R.default.createElement(S,{initialRoute:typeof this<"u"?this.initialRoute:void 0}),t)}var v=B(require("react")),H=require("react-router-dom");function Q(t,o=!0){let{navigator:n}=v.default.useContext(H.UNSAFE_NavigationContext);v.default.useEffect(()=>{if(!o)return;let c=n.go,p=n.push;return n.push=(...m)=>{t()!==!1&&p(...m)},n.go=(...m)=>{t()!==!1&&c(...m)},()=>{n.push=p,n.go=c}},[n,t,o])}function J(t,o=!0,n,c=!1){let p=v.default.useCallback(s=>(s.preventDefault(),s.returnValue=t,s.returnValue),[t]);v.default.useEffect(()=>(o&&!c&&window.addEventListener("beforeunload",p),()=>{window.removeEventListener("beforeunload",p)}),[p,o,c]);let m=v.default.useCallback(()=>{let s=window.confirm(t);return s&&n&&n(),s},[t]);Q(m,o)}var M=({message:t,when:o,setWarnWhen:n})=>(J(t,o,()=>{n==null||n(!1)},!0),null);var T={useHistory:()=>{let t=(0,h.useNavigate)();return{push:t,replace:o=>{t(o,{replace:!0})},goBack:()=>{t(-1)}}},useLocation:h.useLocation,useParams:()=>{let t=(0,h.useParams)(),{pathname:o}=(0,h.useLocation)(),n=`/${Object.values(t).join("/")}`;return(0,X.handleUseParams)({...t,resource:Object.keys(t).length===0?o.substring(1):decodeURIComponent(o.substring(1)).replace(n,"")})},Prompt:M,Link:h.Link,RouterComponent:I},Y=T;
//# sourceMappingURL=legacy.cjs.map